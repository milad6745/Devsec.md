ุญุชูุงู! Falco ฺฉ ุงุฒ **ูููโุชุฑู ู ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ุงุจุฒุงุฑูุง ุงููุช ุฏุฑ Kubernetes** ูุณุชุ ุจูโุฎุตูุต ุฏุฑ ุญูุฒู **Runtime Security**. ุจุฑู ุณุฑุงุบ ุฌุฒุฆุงุช ุฏููโุชุฑ ๐

---

## ๐ก๏ธ Falco ฺุณุชุ

**Falco** ฺฉ ุงุจุฒุงุฑ ูุชูโุจุงุฒ (open-source) ุงุฒ ุดุฑฺฉุช **Sysdig** ู ุนุถู **CNCF** ูุณุช ฺฉู ฺฉุงุฑุด:

> **ูุธุงุฑุช ุจุฑ ุฑูุชุงุฑ ุณุณุชู ุฏุฑ ูุญุธู (runtime)** ู ุชุดุฎุต ูุนุงูุชโูุง ูุดฺฉูฺฉ ุง ุบุฑูุฌุงุฒ ุฏุฑ ูพุงุฏูุงุ ฺฉุงูุชูุฑูุง ู ููุฏูุง Kubernetes ูุณุช.

---

## ๐ Falco ุฏููุงู ฺูโฺฉุงุฑ ูโฺฉููุ

Falco ุจุง ุงุณุชูุงุฏู ุงุฒ:
- **ุณุณุชูโฺฉุงูโูุง (system calls)** ุฏุฑ ูููฺฉุณ
- ุงุทูุงุนุงุช Kubernetes (ูุซู pod nameุ namespace)
- ููุงูู ูุงุจู ุชูุธู

ูโุชููู **ุฑูุชุงุฑูุง ุฎุทุฑูุงฺฉ** ูุซู ููุงุฑุฏ ุฒุฑ ุฑู ุดูุงุณุง ฺฉูู:

| ุฑูุชุงุฑ ุฎุทุฑูุงฺฉ | ูุซุงู |
|--------------|-------|
| ุงุฌุฑุง `bash` ุฏุงุฎู container | `kubectl exec -it pod -- bash` |
| ุชุบุฑ ูุงูโูุง ุณุณุชู ููู | ุชุบุฑ `/etc/passwd` |
| ุงุฌุฑุง ุจุฑูุงููโูุง ูุดฺฉูฺฉ | ุงุฌุฑุง `nmap`, `netcat` ุฏุงุฎู container |
| ุจุงุฒ ฺฉุฑุฏู ูพูุฑุช ุบุฑูุฌุงุฒ | ูุซูุง `port 6666` ุจุฑุง backdoor |
| ุงุชุตุงู ุจู ุณุฑูุณโูุง ุฎุงุฑุฌ ุฎุทุฑูุงฺฉ | ุชูุงุณ ุจุง IP ูุงุดูุงุณ ุง blacklist ุดุฏู |

---

## ๐ง ุงุฌุฒุง Falco

| ุจุฎุด | ุชูุถุญ |
|------|--------|
| **Falco kernel module** | ุจุฑุง ุดูุฏู system callูุง (ุจุง eBPF ุง ูุงฺูู ฺฉุฑูู) |
| **Falco daemon** | ุจุฑุฑุณ system callูุง ู ููุงุณู ุจุง ููุงูู |
| **Falco rules** | ูุณุช ููุงูู ุงููุช ูุงุจู ุชูุธู |
| **Falcosidekick** (ุงุฎุชุงุฑ) | ุจุฑุง ุงุฑุณุงู ูุดุฏุงุฑูุง ุจู Slackุ Discordุ Elasticsearchุ Prometheus ู ุบุฑู |

---

## โ๏ธ ูุตุจ Falco ุฏุฑ Kubernetes (ุจุง Helm)

### 1. ุงุถุงูู ฺฉุฑุฏู Helm repo:
```bash
helm repo add falcosecurity https://falcosecurity.github.io/charts
helm repo update
```

### 2. ูุตุจ Falco:
```bash
helm install falco falcosecurity/falco
```

ุจูโุทูุฑ ูพุดโูุฑุถุ ฺฉ DaemonSet ูุตุจ ูโุดู ฺฉู ุฑู ูุฑ Node ุงุฌุฑุง ูโุดู.

---

## ๐ ูุซุงู ุงุฒ ูุงููู Falco

```yaml
- rule: Terminal shell in container
  desc: Detected a shell running in a container
  condition: container and shell_procs
  output: >
    Shell run inside container (user=%user.name container=%container.name)
  priority: WARNING
  tags: [container, shell]
```

โฌ๏ธ ุงู ูุงููู ูโฺฏู ุงฺฏุฑ ฺฉุณ ุฏุงุฎู container ู shell ุจุงุฒ ฺฉููุ ูุดุฏุงุฑ ุจุฏู.

---

## ๐ฆ ุฎุฑูุฌโูุง Falco

Falco ุฎุฑูุฌโูุงุด ุฑู ูโุชููู ุจูุฑุณุชู ุจู:

- stdout (ูพุดโูุฑุถ)
- ูุงู ูุงฺฏ
- ุงุจุฒุงุฑูุง ูุดุฏุงุฑุฏู (ุจุง **Falcosidekick**):
  - Slack
  - Prometheus
  - Loki
  - Webhook
  - Email

---

## ๐ ฺุฑุง Falco ููููุ

ฺูู Kubernetes ุจูโุชููุง ุงุฒ ูุธุฑ runtime ุงููุช ฺฉุงู ูุฏุงุฑู. Kubernetes ูโุชููู ูุดุฎุต ฺฉูู ฺู ฺฉุณ ฺ **ุจุณุงุฒู**ุ ูู Falco ูุดุฎุต ูโฺฉูู ฺู ฺฉุณ ุฏุงุฑู **ฺ ุงุฌุฑุง ูโฺฉูู** โ ุงููู **ุฏุฑ ูุญุธู**.

---

## ๐ฏ ุชุฑฺฉุจ ุนุงู Falco ุจุง:

- **Trivy** ุจุฑุง ุงุณฺฉู imageูุง
- **Kyverno/OPA** ุจุฑุง policy ุฏุฑ admission
- **Loki ุง Prometheus** ุจุฑุง ูุงูุชูุฑูฺฏ ุฎุฑูุฌ Falco

---

ุงฺฏู ุจุฎูุงุ ูโุชููู ู ุณูุงุฑู ฺฉุงูู ุงุฒ ุดูุงุณุง exec ุฏุงุฎู ฺฉ ูพุงุฏ ูุงูุน ุจุง Falco ุจุฑุงุช ุชูุธู ฺฉูู. ุฏูุณุช ุฏุงุฑ ุงูู ุฏูู ุฑู ูู ุจููุณูุ

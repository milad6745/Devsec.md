 یک ابزار متن‌باز برای شناسایی و تحلیل **رمزهای عبور، کلیدهای API و سایر اطلاعات حساس** است که به اشتباه در تاریخچه گیت (Git history) قرار گرفته‌اند. این ابزار به‌ویژه برای تیم‌های امنیتی و توسعه‌دهندگان مفید است تا از نشت اطلاعات حساس جلوگیری کنند.

---

## 🔍 ویژگی‌های کلیدی TruffleHog

* **جستجوی تاریخچه گیت:** با استفاده از الگوریتم‌های پیچیده، TruffleHog می‌تواند به عمق تاریخچه گیت نفوذ کرده و کلیدها و رمزهای عبور را شناسایی کند.

* **پشتیبانی از منابع مختلف:** این ابزار می‌تواند در منابع مختلفی مانند گیت، سیستم‌های فایل، S3 و سایر منابع جستجو کند.

* **یکپارچگی با CI/CD:** TruffleHog می‌تواند در پایپ‌لاین‌های CI/CD مانند GitHub Actions، CircleCI و TravisCI یکپارچه شود تا به‌طور خودکار مخازن گیت را برای کلیدهای جدید بررسی کند.([trufflesecurity.com][1])

* **پشتیبانی از انواع مختلف کلیدها:** این ابزار قادر به شناسایی بیش از ۸۰۰ نوع مختلف از کلیدها و اطلاعات حساس است.

---

## 🛠️ مثال استفاده از TruffleHog

برای استفاده از TruffleHog در یک مخزن گیت، می‌توانید از دستور زیر استفاده کنید:

```bash
trufflehog --json https://github.com/username/repository
```



این دستور مخزن مشخص‌شده را بررسی کرده و نتایج را به‌صورت JSON نمایش می‌دهد.

---

## 🔐 یکپارچگی با Burp Suite

TruffleHog همچنین دارای یک افزونه برای Burp Suite است که می‌تواند ترافیک Burp را برای شناسایی بیش از ۸۰۰ نوع مختلف از کلیدها و اطلاعات حساس بررسی کند.

---

## 📦 نسخه‌های مختلف TruffleHog

* **نسخه متن‌باز:** برای استفاده در محیط‌های توسعه و بررسی‌های دستی مناسب است.

* **نسخه سازمانی:** برای استفاده در محیط‌های تولید و یکپارچه‌سازی با سیستم‌های CI/CD طراحی شده است.

---

برای اطلاعات بیشتر و دریافت نسخه‌های مختلف TruffleHog، می‌توانید به [مخزن رسمی TruffleHog در GitHub](https://github.com/trufflesecurity/trufflehog) مراجعه کنید.

---



---

## فرض سناریو

فرض کن یک مخزن گیت داری که **به‌طور اشتباه یک کلید API داخل commitها ذخیره شده است**:

```
my-repo/
│
├── .git/
├── README.md
└── config.py
```

مثلاً در `config.py` یک کلید API اشتباه گذاشته‌ایم:

```python
# config.py
API_KEY = "AKIAIOSFODNN7EXAMPLE"
```

سپس این فایل را commit کرده‌ایم و push شده به GitHub.

---

## نصب TruffleHog

ابتدا TruffleHog را نصب می‌کنیم:

```bash
pip install trufflehog
```

---

## اجرای TruffleHog روی مخزن

```bash
trufflehog https://github.com/username/my-repo
```

### چیزی که اتفاق می‌افتد:

* TruffleHog **تمام commitهای مخزن** را بررسی می‌کند.
* رشته‌هایی که شبیه **کلید API، توکن یا پسورد** هستند را پیدا می‌کند.
* خروجی چیزی شبیه این است:

```
[HIGH] Found possible secret in commit 1a2b3c4d:
config.py: API_KEY = "AKIAIOSFODNN7EXAMPLE"
```

---

## گزینه‌های مفید

* خروجی JSON:

```bash
trufflehog --json https://github.com/username/my-repo > results.json
```

* فقط بررسی branch خاص:

```bash
trufflehog --branch main https://github.com/username/my-repo
```

---

### ✅ جمع‌بندی

* **هدف TruffleHog:** پیدا کردن کلیدها و اطلاعات حساس که **به‌صورت تصادفی داخل Git history قرار گرفته‌اند**.
* **کاربرد عملی:** قبل از انتشار یا merge کردن کد به مخزن اصلی، بررسی کنیم که **هیچ secret یا API key نشت نکرده باشد**.
* **مزیت:** حتی اگر کلید در commit قدیمی باشد، TruffleHog آن را پیدا می‌کند.

---



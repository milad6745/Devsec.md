ุญุชูุงู! ุจุงู ููู ฺุฒ ุฑุง ุงุฒ ุงูู ูุฑุชุจ ฺฉูู ู ุจุง ุชูุถุญุงุช ฺฉุงูู ุจููุณู ุชุง ฺฉ ูฺฏุงู ุฌุงูุน ุฑู **Seccomp ู ูพุฑููุงูโูุง Docker** ุฏุงุดุชู ุจุงุดูุ ู ุฏุฑ ููุงุช ูพุฑููุงู ุฏุงุดุชู ุจุงุดู ฺฉู ููู ฺุฒ ูุนุงู ุจุงุดู ูู `mount` ุจูุงฺฉ ุจุดู.

---

# ฑ๏ธโฃ Seccomp ฺุณุชุ

**Seccomp (Secure Computing Mode)** ฺฉ ูฺฉุงูุฒู ุงููุช ุฏุฑ ูููฺฉุณ ุงุณุช ฺฉู ุจู ูพุฑูุณูโูุง ุงุฌุงุฒู ูโุฏูุฏ **ูุฌููุนูโุง ุงุฒ system callูุง ุฑุง ูุญุฏูุฏ ุง ุงุฌุงุฒู ุฏููุฏ**.

* ุฏุฑ Dockerุ ุงุฒ Seccomp ุจุฑุง **ูุญุฏูุฏ ฺฉุฑุฏู ุฏุณุชุฑุณ ฺฉุงูุชูุฑ ุจู syscallูุง ุญุณุงุณ** ุงุณุชูุงุฏู ูโุดูุฏ.
* ุจู ุงู ุดฺฉู ูโุชูุงู ฺฉุงูุชูุฑ ุฑุง ุงููโุชุฑ ฺฉุฑุฏ ู ุฌูู ุงุฌุฑุง syscallูุง ุฎุทุฑูุงฺฉ ุฑู ูุฒุจุงู ุฑุง ฺฏุฑูุช.

### ๐น ูุซุงู ฺฉุงุฑุจุฑุฏ:

* ุฌููฺฏุฑ ุงุฒ ุงุฌุฑุง `mount` ุฏุงุฎู ฺฉุงูุชูุฑ
* ุฌููฺฏุฑ ุงุฒ ุชุบุฑ namespaceูุง
* ุงุฌุงุฒู ุฏุงุฏู ููุท ุจู syscallูุง ุถุฑูุฑ ุจุฑุง ุงุฌุฑุง ุจุฑูุงูู ุฏุงุฎู ฺฉุงูุชูุฑ

---

# ฒ๏ธโฃ ุณุงุฎุชุงุฑ ูพุฑููุงู Seccomp ุฏุฑ Docker

ฺฉ ูพุฑููุงู Seccomp ูุนูููุงู JSON ุงุณุช ู ุดุงูู ุงู ุจุฎุดโูุงุณุช:

1. **defaultAction**

   * ูุดุฎุต ูโฺฉูุฏ syscallูุง ฺฉู ุฏุฑ ูุณุช ูุณุชูุฏ ฺู ุงุชูุงู ุจุงูุชุฏ.
   * ูููููโูุง:

     * `SCMP_ACT_ALLOW` โ ุงุฌุงุฒู ุงุฌุฑุง
     * `SCMP_ACT_ERRNO` โ ุฎุทุง ุจุฑฺฏุฑุฏุงูุฏู ุดูุฏ
     * `SCMP_ACT_KILL` โ ฺฉุงูุชูุฑ ูุชููู ุดูุฏ

2. **syscalls**

   * ฺฉ ุขุฑุงู ุงุฒ ููุงูู ุจุฑุง syscallูุง ุฎุงุต
   * ูุฑ ูุงููู ุดุงูู:

     * `names` โ ูุณุช syscallูุง ููุฑุฏ ูุธุฑ
     * `action` โ ฺู ุนูู ุฑู ุขู syscall ุงูุฌุงู ุดูุฏ

---

# ณ๏ธโฃ ููููู ูพุฑููุงู ูุญุฏูุฏฺฉููุฏู (ูููุงู)

ูุซูุงู ูโุฎูุงูู ููุท syscallูุง ูุงุฒู ุจุฑุง ุงุฌุฑุง ฺฉ Alpine ุณุงุฏู ุฑุง ุงุฌุงุฒู ุจุฏูู:

```json
{
  "defaultAction": "SCMP_ACT_ERRNO",
  "syscalls": [
    {
      "names": ["read","write","exit","sigreturn","open","close","execve"],
      "action": "SCMP_ACT_ALLOW"
    }
  ]
}
```

โ ุงู ูพุฑููุงู ุจุงุนุซ ูโุดูุฏ ฺฉู ุชููุง syscallูุง ูุณุช ุดุฏู ุงุฌุงุฒู ุฏุงุดุชู ุจุงุดูุฏ ู ุจูู ุฎุทุง ุจุฏููุฏ.

โ ูุดฺฉู: ุงฺฏุฑ syscallูุง ููุฑุฏ ูุงุฒ ูุซู `getdents64` ุง `fstatfs` ุญุฐู ุดููุฏุ ฺฉุงูุชูุฑ ุงุตูุงู ุจุงูุง ููโุขุฏ.

---

# ด๏ธโฃ ูุณุฎู ููุง ูพุดููุงุฏ ุดูุง: ููู ฺุฒ ูุนุงู ูู mount ุจูุงฺฉ ุดูุฏ

ุทุจู ุฏุฑุฎูุงุณุช ุดูุงุ ูโุฎูุงูู:

* **ููู syscallูุง ูุนุงู ุจุงุดูุฏ** (ุชุง ฺฉุงูุชูุฑ ููู ฺฉุงุฑูุง ุฑุง ุงูุฌุงู ุฏูุฏ)
* ูู syscallูุง ูุฑุจูุท ุจู **mount ู umount** ุฎุทุง ุจุฏููุฏ

```json
{
  "defaultAction": "SCMP_ACT_ALLOW",
  "syscalls": [
    {
      "names": ["mount", "umount", "umount2"],
      "action": "SCMP_ACT_ERRNO"
    }
  ]
}
```

### ๐น ุชูุถุญ:

* `defaultAction: SCMP_ACT_ALLOW` โ ููู syscallูุง ุงุฌุงุฒู ุฏุงุฑูุฏ
* `mount, umount, umount2` โ ุงฺฏุฑ ุงุฌุฑุง ุดููุฏุ **ุฎุทุง EPERM ุจุฑูโฺฏุฑุฏุฏ**
* ฺฉุงูุชูุฑ ูโุชูุงูุฏ ุงุฌุฑุง ุดูุฏ ู ุงฺฉุซุฑ ุจุฑูุงููโูุง ุจุฏูู ูุดฺฉู ฺฉุงุฑ ฺฉููุฏ
* ููุท ุนููุงุช mount ูุณุฏูุฏ ูโุดูุฏ

### ๐น ูุญูู ุงุฌุฑุง:

```bash
docker run --rm --security-opt seccomp=profile.json alpine:latest
```

---

ุงฺฏุฑ ุจุฎูุงูู ูโุชูุงูู ฺฉ **ูุณุฎู ูพุดุฑูุชูโุชุฑ** ุจุณุงุฒู ฺฉู ููุท mountูุง ุฎุงุต (ูุซู bind mounts ุง network mounts) ุฑุง ุจูุงฺฉ ฺฉูุฏ ูู mountูุง read-only ุณุงุฏู ุฑุง ุขุฒุงุฏ ฺฉูุฏ.

ูโุฎูุง ุงูู ูุณุฎู ูพุดุฑูุชู ุฑุง ูู ุขูุงุฏู ฺฉููุ
